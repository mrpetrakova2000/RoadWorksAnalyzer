# RoadWorksAnalyzer - проект аналитической платформы для анализа ремонтных работ в Москве
Разработка аналитической платформы для мониторинга и анализа ремонтных работ на дорогах Москвы представляет собой важный шаг к оптимизации процессов планирования и принятия решений администрацией. Основная цель данной платформы заключается в предотвращении одновременного перекрытия нескольких участков дорог в одном районе, что может привести к значительным заторам и неудобствам для автомобилистов. На текущий момент данные, представленные в рамках данной платформы, не предполагаются для дальнейшего использования в моделях машинного обучения. Они предназначены исключительно для создания дашбордов и визуализации информации, что позволит администрации района и города принимать обоснованные решения на основе актуальных данных.

## 1. Сбор данных
Данные получены напрямую с портала открытых данных Москвы (https://data.mos.ru/). В директории sources представлены csv-файлы с данными, скачанные с портала за конкретный день.
Ссылки на источники:
- https://data.mos.ru/opendata/2527?pageSize=10&pageIndex=0&version=1&release=1664
- https://data.mos.ru/opendata/62101?pageSize=10&pageIndex=0&isRecommendationData=true&isDynamic=false&version=2&release=101

Также рассматривается интеграция с API Яндекс Карт для получения актуальной информации о пробках для анализа корреляции с ними дорожных работ.

## 2. Предобработка и интеграция данных
Предобработка данных из 1 и 2 источника приведена в Moscow_data_EDA.ipynb и Moscow_alter_data_EDA.ipynb соответственно.
Она включает в себя:
- очистку данных;
- заполнение пропусков;
- анализ значений полей.
  
Ввиду предполагаемого сценария дальнейшего использования данных (не для моделей ML), данные не размечаются и не нормализуются.

**Интеграция данных**

Поскольку структура данных источников различна, есть необходимость проведения интеграции данных. Более подбробно можно ознакомиться в Moscow_all.ipynb.

## 3. Исследовательский анализ данных
Исследовательский анализ приведен в файле Analysis.ipynb. Построены графики, отражающие статистику и характер изменения данных, а также приведена карта в формате html, позволяющая просмотреть текущие ремонтные работы в Москве, с возможностью выбора административного округа. Планы анализа приведены в файле Analysis.docx.

## 4. Определение и обоснование метрик качества данных
Метрики, необходимые для оценки качества данных, приведены ниже:

1. NULL_DATA: Эта метрика показывает процент строк, содержащих пропущенные значения (NaN) в важных колонках, таких как global_id, Address, AdmArea, District и т.д.
2. NULL_DATA_COUNT: Эта метрика показывает общий процент пропущенных значений во всех важных колонках. Она рассчитывается путем суммирования количества пропущенных значений во всех важных колонках и деления этой суммы на общее количество значений во всех важных колонках.
3. DATE_COORDINATES_ERROR: Эта метрика показывает процент строк с некорректным форматом географических координат, хранящихся в колонке geoData.
4. DATE_FORMAT_ERROR: Эта метрика показывает процент строк с некорректным форматом дат в колонках, содержащих даты, таких как ActualBeginDate, WorksBeginDate, ActualEndDate, PlannedEndDate.
5. DATE_CONSISTENCY: Эта метрика показывает процент строк с несогласованными датами. Например, если дата начала работ позже даты окончания работ, это считается несогласованностью.
6. DATA_DUPLICATES: Эта метрика показывает процент строк-дубликатов в датасете.

Эти метрики были выбраны, поскольку они отражают важные аспекты качества данных, которые критичны для анализа данных о дорожных работах:

1. NULL_DATA и NULL_DATA_COUNT: Пропущенные данные могут привести к неточным результатам анализа. Важно знать, насколько распространены пропуски в данных, чтобы принять решение о том, как с ними обращаться (например, заполнить пропущенные значения или удалить строки с пропусками).
2. DATE_COORDINATES_ERROR: Некорректные координаты делают данные о местоположении бесполезными. Поэтому важно контролировать корректность формата координат.
3. DATE_FORMAT_ERROR: Некорректный формат дат может привести к ошибкам при обработке данных, связанных со временем. Важно, чтобы все даты были представлены в едином формате для корректного анализа.
4. DATE_CONSISTENCY: Несогласованные даты указывают на ошибки в данных и могут привести к неверным выводам. Важно проверять согласованность дат, чтобы обеспечить достоверность данных.
5. DATA_DUPLICATES: Дубликаты могут исказить результаты анализа. Важно знать их количество и принимать меры по их устранению, чтобы избежать искажений.
В целом, выбранные метрики позволяют оценить полноту, достоверность, согласованность и уникальность данных о дорожных работах, что важно для проведения корректного анализа и получения достоверных результатов.

Затем была проведена оценка качества данных согласно с метриками. Реализация приведена в файле notebooks/Quality.ipynb. Результаты оценки приведены ниже.
```yaml
{
 'NULL_DATA': '5.2043%',
 'NULL_DATA_COUNT': '0.0049%',
 'DATE_COORDINATES_ERROR': '0.0000%',
 'DATE_FORMAT_ERROR': '5.2043%',
 'DATE_CONSISTENCY': '5.2043%',
 'DATA_DUPLICATES': '0.0000%'
}
```

## 5. Разработка базы данных для хранения данных
В проекте используется реляционная база данных PostgreSQL для хранения информации о дорожных работах. Основные компоненты базы данных и используемые технологии включают:
* PostgreSQL: Это основная система управления базами данных, которая обеспечивает надежное хранение и обработку данных. Она поддерживает сложные запросы и транзакции, что важно для работы с большими объемами информации.
* SQLAlchemy: Библиотека для Python, которая предоставляет ORM (Object-Relational Mapping) для упрощения взаимодействия с базой данных. Она позволяет разработчику работать с базой данных через объекты Python, что делает код более чистым и удобным.
* psycopg2: Это адаптер PostgreSQL для Python, который позволяет выполнять SQL-запросы напрямую. Он используется для создания соединений с базой данных и выполнения команд SQL.

**Структура базы данных**

В базе данных создается таблица road_works со следующими полями:
```yaml
{
  global_id: уникальный идентификатор (BIGSERIAL)
  address: адрес дорожных работ (TEXT)
  admarea: административный район (TEXT)
  district: район (TEXT)
  workstype: тип работ (TEXT)
  worksstatus: статус работ (TEXT)
  customer: заказчик работ (TEXT)
  actualbegindate: фактическая дата начала работ (DATE)
  worksbegindate: запланированная дата начала работ (DATE)
  actualenddate: фактическая дата окончания работ (DATE)
  plannedenddate: запланированная дата окончания работ (DATE)
  lanes_closed: количество закрытых полос (INTEGER)
  geodata: географические данные (TEXT)
  workyear: год проведения работ (INTEGER)
}
```
Подключение к локальной БД реализовано и настроено в файле директории pipeline: db.py.

## 6. Оформление пунктов 1,2 и 5 в отдельный пайплайн для автоматизации
Для удобства описанные выше шаги объединены в пайплайн для автоматизации обработки данных. Реализация приведена в директории pipeline. В README (https://github.com/mrpetrakova2000/RoadWorksAnalyzer/blob/main/pipeline/README.md) можно ознакомиться с порядком запуска пайплайна, файл pipeline.py представляет собой последовательный вызов шагов.  

## 7. Оформление Дашборда
Реализация дашборда по данным приведена в директории https://github.com/mrpetrakova2000/RoadWorksAnalyzer/tree/main/pipeline/analysis/20241226_210635. Для его просмотра необходимо скачать содержимое папки и запустить файл dashbord.html.

## 8. Оформление презентации/пояснительной записки о работе
Презентация приведена по ссылке: **ДОБАВИТЬ**
